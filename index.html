<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZaniLibrary - Free Ebooks Library</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffffff 0%, #f8fffe 100%);
            color: #333;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #ffffff 0%, #e8f5e8 100%);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #2d5a3d;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-menu a {
            text-decoration: none;
            color: #2d5a3d;
            font-weight: 500;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .nav-menu a:hover, .nav-menu a.active {
            color: #4caf50;
        }

        .search-container {
            display: flex;
            gap: 10px;
        }

        .search-box {
            padding: 8px 15px;
            border: 2px solid #e8f5e8;
            border-radius: 25px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-box:focus {
            border-color: #4caf50;
        }

        .search-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #45a049;
        }

        /* Main Content */
        .main-content {
            margin-top: 70px;
            min-height: calc(100vh - 140px);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #e8f5e8 0%, #ffffff 100%);
            text-align: center;
            padding: 80px 20px;
        }

        .hero h1 {
            font-size: 3.5em;
            color: #2d5a3d;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.3em;
            color: #555;
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            background: #4caf50;
            color: white;
            padding: 15px 40px;
            text-decoration: none;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: 600;
            display: inline-block;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .cta-button:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        /* Content Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Categories */
        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }

        .category-card {
            background: white;
            padding: 30px 20px;
            text-align: center;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #4caf50;
        }

        .category-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .category-card h3 {
            color: #2d5a3d;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .category-card p {
            color: #666;
            font-size: 0.9em;
        }

        /* Book Grid */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .book-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .book-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
        }

        .book-cover {
            height: 300px;
            background: linear-gradient(135deg, #4caf50, #2d5a3d);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2em;
            font-weight: bold;
        }

        .book-info {
            padding: 20px;
        }

        .book-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d5a3d;
            margin-bottom: 8px;
        }

        .book-author {
            color: #666;
            margin-bottom: 10px;
        }

        .book-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .stars {
            color: #ffc107;
        }

        .book-genre {
            background: #e8f5e8;
            color: #2d5a3d;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            display: inline-block;
        }

        /* AdSense Placeholders */
        .ad-container {
            background: #f5f5f5;
            border: 2px dashed #ccc;
            padding: 40px 20px;
            text-align: center;
            margin: 30px 0;
            border-radius: 10px;
        }

        .ad-container h4 {
            color: #666;
            margin-bottom: 10px;
        }

        .ad-container p {
            color: #888;
            font-size: 0.9em;
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-header h2 {
            font-size: 2.5em;
            color: #2d5a3d;
            margin-bottom: 15px;
        }

        .section-header p {
            font-size: 1.1em;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Footer */
        .footer {
            background: #2d5a3d;
            color: white;
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer h3 {
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .footer p {
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            transition: opacity 0.3s ease;
        }

        .footer-links a:hover {
            opacity: 0.7;
        }

        /* Hidden sections for navigation */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Reading page styles */
        .reading-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .book-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .book-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            line-height: 1.8;
            font-size: 1.1em;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.5em;
            }
            
            .categories {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .books-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <a href="#" class="logo" onclick="showSection('home')">üìö ZaniLibrary</a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#" class="active" onclick="showSection('home')">Home</a></li>
                    <li><a href="#" onclick="showSection('categories')">Categories</a></li>
                    <li><a href="#" onclick="showSection('popular')">Popular</a></li>
                    <li><a href="#" onclick="showSection('new-releases')">New Releases</a></li>
                    <li><a href="#" onclick="showSection('about')">About</a></li>
                </ul>
            </nav>
            <div class="search-container">
                <input type="text" class="search-box" placeholder="Search books...">
                <button class="search-btn">üîç</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Section -->
        <section id="home" class="page-section active">
            <!-- Hero Section -->
            <div class="hero">
                <h1>Welcome to ZaniLibrary</h1>
                <p>Discover thousands of free ebooks across all genres. Start your reading journey today with our vast collection of classic and contemporary literature.</p>
                <a href="#" class="cta-button" onclick="showSection('categories')">Explore Books</a>
            </div>

            <!-- AdSense Ad -->
            <div class="ad-container">
                <h4>Advertisement</h4>
                <p>Google AdSense banner ad would appear here<br>728x90 leaderboard format</p>
            </div>

            <div class="container">
                <!-- Featured Categories -->
                <div class="section-header">
                    <h2>Browse by Category</h2>
                    <p>Find your next favorite book from our carefully curated categories</p>
                </div>

                <div class="categories">
                    <div class="category-card" onclick="filterBooks('fiction')">
                        <div class="category-icon">üìñ</div>
                        <h3>Fiction</h3>
                        <p>Novels, stories, and literary works</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('non-fiction')">
                        <div class="category-icon">üìö</div>
                        <h3>Non-Fiction</h3>
                        <p>Biographies, history, and factual works</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('science')">
                        <div class="category-icon">üî¨</div>
                        <h3>Science</h3>
                        <p>Scientific discoveries and theories</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('mystery')">
                        <div class="category-icon">üïµÔ∏è</div>
                        <h3>Mystery</h3>
                        <p>Thrilling mysteries and detective stories</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('romance')">
                        <div class="category-icon">üíù</div>
                        <h3>Romance</h3>
                        <p>Love stories and romantic novels</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('fantasy')">
                        <div class="category-icon">üßô</div>
                        <h3>Fantasy</h3>
                        <p>Magical worlds and epic adventures</p>
                    </div>
                </div>

                <!-- Featured Books -->
                <div class="section-header">
                    <h2>Featured Books</h2>
                    <p>Start with these popular titles from our collection</p>
                </div>

                <div class="books-grid" id="featured-books">
                    <!-- Books will be populated by JavaScript -->
                </div>

                <!-- AdSense Ad -->
                <div class="ad-container">
                    <h4>Advertisement</h4>
                    <p>Google AdSense square ad would appear here<br>336x280 large rectangle format</p>
                </div>
            </div>
        </section>

        <!-- Categories Section -->
        <section id="categories" class="page-section">
            <div class="container">
                <div class="section-header">
                    <h2>All Categories</h2>
                    <p>Browse our complete collection by genre</p>
                </div>

                <div class="categories">
                    <div class="category-card" onclick="filterBooks('fiction')">
                        <div class="category-icon">üìñ</div>
                        <h3>Fiction</h3>
                        <p>1,250+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('non-fiction')">
                        <div class="category-icon">üìö</div>
                        <h3>Non-Fiction</h3>
                        <p>850+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('science')">
                        <div class="category-icon">üî¨</div>
                        <h3>Science</h3>
                        <p>430+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('mystery')">
                        <div class="category-icon">üïµÔ∏è</div>
                        <h3>Mystery & Thriller</h3>
                        <p>670+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('romance')">
                        <div class="category-icon">üíù</div>
                        <h3>Romance</h3>
                        <p>520+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('fantasy')">
                        <div class="category-icon">üßô</div>
                        <h3>Fantasy & Sci-Fi</h3>
                        <p>380+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('history')">
                        <div class="category-icon">üèõÔ∏è</div>
                        <h3>History</h3>
                        <p>340+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('philosophy')">
                        <div class="category-icon">ü§î</div>
                        <h3>Philosophy</h3>
                        <p>290+ books</p>
                    </div>
                    <div class="category-card" onclick="filterBooks('poetry')">
                        <div class="category-icon">üé≠</div>
                        <h3>Poetry & Drama</h3>
                        <p>180+ books</p>
                    </div>
                </div>

                <div class="books-grid" id="category-books">
                    <!-- Books will be populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Popular Books Section -->
        <section id="popular" class="page-section">
            <div class="container">
                <div class="section-header">
                    <h2>Most Popular Books</h2>
                    <p>Discover what other readers are enjoying</p>
                </div>

                <div class="books-grid" id="popular-books">
                    <!-- Books will be populated by JavaScript -->
                </div>

                <!-- AdSense Ad -->
                <div class="ad-container">
                    <h4>Advertisement</h4>
                    <p>Google AdSense banner ad would appear here<br>728x90 leaderboard format</p>
                </div>
            </div>
        </section>

        <!-- New Releases Section -->
        <section id="new-releases" class="page-section">
            <div class="container">
                <div class="section-header">
                    <h2>New Releases</h2>
                    <p>Recently added books to our collection</p>
                </div>

                <div class="books-grid" id="new-books">
                    <!-- Books will be populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="page-section">
            <div class="container">
                <div class="section-header">
                    <h2>About ZaniLibrary</h2>
                    <p>Your gateway to free literature</p>
                </div>

                <div style="max-width: 800px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
                    <h3 style="color: #2d5a3d; margin-bottom: 20px;">Our Mission</h3>
                    <p style="margin-bottom: 20px;">ZaniLibrary is dedicated to making literature accessible to everyone. We believe that great books should be available to all readers, regardless of their economic situation.</p>

                    <h3 style="color: #2d5a3d; margin-bottom: 20px;">What We Offer</h3>
                    <p style="margin-bottom: 20px;">Our platform provides access to thousands of free ebooks across all genres, from classic literature to contemporary works. All books are legally available and sourced from public domain collections and author partnerships.</p>

                    <h3 style="color: #2d5a3d; margin-bottom: 20px;">Quality & Curation</h3>
                    <p style="margin-bottom: 20px;">Every book in our collection is carefully reviewed for quality and formatting. We ensure that your reading experience is smooth and enjoyable across all devices.</p>

                    <h3 style="color: #2d5a3d; margin-bottom: 20px;">Contact Us</h3>
                    <p>Have questions or suggestions? We'd love to hear from you at info@zanilibrary.com</p>
                </div>

                <!-- AdSense Ad -->
                <div class="ad-container">
                    <h4>Advertisement</h4>
                    <p>Google AdSense square ad would appear here<br>336x280 large rectangle format</p>
                </div>
            </div>
        </section>

        <!-- Reading Section -->
        <section id="reading" class="page-section">
            <div class="reading-container">
                <div class="book-header">
                    <h1 id="reading-title">Book Title</h1>
                    <p id="reading-author">by Author Name</p>
                </div>

                <div class="book-content" id="book-content">
                    <p>Loading book content...</p>
                </div>

                <!-- AdSense Ad -->
                <div class="ad-container">
                    <h4>Advertisement</h4>
                    <p>Google AdSense banner ad would appear here<br>728x90 leaderboard format</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <h3>ZaniLibrary</h3>
            <p>Making literature accessible to everyone, everywhere.</p>
            <div class="footer-links">
                <a href="#" onclick="showSection('about')">About</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="#">Contact</a>
                <a href="#">Help</a>
            </div>
            <p>&copy; ZaniLibrary. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Real book data storage
        let books = [];
        let allBooks = [];
        
        // API Configuration
        const API_CONFIG = {
            GUTENDX: 'https://gutendx.com/books/',
            OPENLIBRARY: 'https://openlibrary.org/api/books',
            SEARCH_LIMIT: 50
        };

        // Genre mapping for categorization
        const GENRE_MAPPING = {
            'fiction': ['fiction', 'novel', 'story', 'literature'],
            'non-fiction': ['biography', 'history', 'science', 'philosophy', 'politics', 'religion'],
            'science': ['science', 'physics', 'chemistry', 'biology', 'mathematics', 'astronomy'],
            'mystery': ['mystery', 'detective', 'crime', 'thriller', 'suspense'],
            'romance': ['romance', 'love', 'relationship'],
            'fantasy': ['fantasy', 'science fiction', 'sci-fi', 'adventure', 'fairy', 'magic'],
            'history': ['history', 'historical', 'war', 'biography', 'memoir'],
            'philosophy': ['philosophy', 'ethics', 'logic', 'metaphysics', 'moral'],
            'poetry': ['poetry', 'poems', 'verse', 'drama', 'plays']
        };

        // Fetch books from Gutendex API
        async function fetchBooksFromGutendex(subject = '', limit = 30) {
            try {
                let url = `${API_CONFIG.GUTENDX}?`;
                if (subject) {
                    url += `topic=${encodeURIComponent(subject)}&`;
                }
                url += `page_size=${limit}&languages=en`;

                const response = await fetch(url);
                const data = await response.json();
                
                return data.results.map(book => ({
                    id: book.id,
                    title: book.title,
                    author: book.authors.length > 0 ? book.authors[0].name : 'Unknown Author',
                    genre: categorizeBook(book),
                    rating: generateRating(),
                    cover: book.title.substring(0, 20) + '...',
                    downloadCount: book.download_count || 0,
                    subjects: book.subjects || [],
                    formats: book.formats || {},
                    popular: book.download_count > 1000,
                    new: isRecentlyAdded(book),
                    language: book.languages[0] || 'en'
                }));
            } catch (error) {
                console.error('Error fetching from Gutendex:', error);
                return [];
            }
        }

        // Categorize books based on subjects
        function categorizeBook(book) {
            const subjects = book.subjects.map(s => s.toLowerCase()).join(' ');
            const title = book.title.toLowerCase();
            
            for (const [genre, keywords] of Object.entries(GENRE_MAPPING)) {
                if (keywords.some(keyword => subjects.includes(keyword) || title.includes(keyword))) {
                    return genre;
                }
            }
            return 'fiction'; // default category
        }

        // Generate realistic ratings
        function generateRating() {
            return (Math.random() * 2 + 3).toFixed(1); // Between 3.0 and 5.0
        }

        // Check if book is recently added (mock logic)
        function isRecentlyAdded(book) {
            return Math.random() > 0.8; // 20% chance of being "new"
        }

        // Load books by category
        async function loadBooksByCategory(category) {
            const keywords = GENRE_MAPPING[category] || [category];
            let categoryBooks = [];
            
            // Try multiple keywords for better results
            for (const keyword of keywords.slice(0, 2)) {
                const books = await fetchBooksFromGutendex(keyword, 15);
                categoryBooks = [...categoryBooks, ...books];
                if (categoryBooks.length >= 20) break;
            }
            
            return categoryBooks.slice(0, 20);
        }

        // Initialize books data
        async function initializeBooks() {
            try {
                // Show loading indicator
                showLoadingIndicator();
                
                // Load popular books (high download count)
                const popularBooks = await fetchBooksFromGutendex('', 30);
                
                // Load books from different categories
                const fictionBooks = await loadBooksByCategory('fiction');
                const scienceBooks = await loadBooksByCategory('science');
                const mysteryBooks = await loadBooksByCategory('mystery');
                const romanceBooks = await loadBooksByCategory('romance');
                const fantasyBooks = await loadBooksByCategory('fantasy');
                
                // Combine and deduplicate
                allBooks = [
                    ...popularBooks,
                    ...fictionBooks,
                    ...scienceBooks,
                    ...mysteryBooks,
                    ...romanceBooks,
                    ...fantasyBooks
                ].reduce((unique, book) => {
                    if (!unique.find(b => b.id === book.id)) {
                        unique.push(book);
                    }
                    return unique;
                }, []);
                
                books = allBooks;
                
                // Update categories with actual counts
                updateCategoryCounts();
                
                // Hide loading indicator
                hideLoadingIndicator();
                
                // Refresh current view
                const currentSection = document.querySelector('.page-section.active').id;
                showSection(currentSection);
                
            } catch (error) {
                console.error('Error initializing books:', error);
                hideLoadingIndicator();
                // Fallback to sample data if API fails
                loadSampleData();
            }
        }

        // Update category cards with real counts
        function updateCategoryCounts() {
            const categories = {
                'fiction': books.filter(b => b.genre === 'fiction').length,
                'non-fiction': books.filter(b => b.genre === 'non-fiction').length,
                'science': books.filter(b => b.genre === 'science').length,
                'mystery': books.filter(b => b.genre === 'mystery').length,
                'romance': books.filter(b => b.genre === 'romance').length,
                'fantasy': books.filter(b => b.genre === 'fantasy').length,
                'history': books.filter(b => b.genre === 'history').length,
                'philosophy': books.filter(b => b.genre === 'philosophy').length,
                'poetry': books.filter(b => b.genre === 'poetry').length
            };

            // Update category cards in categories section
            const categoryCards = document.querySelectorAll('.category-card p');
            categoryCards.forEach(card => {
                const categoryName = card.parentNode.querySelector('h3').textContent.toLowerCase();
                const mainCategory = categoryName.includes('sci-fi') ? 'fantasy' : 
                                   categoryName.includes('thriller') ? 'mystery' : 
                                   categoryName.includes('drama') ? 'poetry' : 
                                   categoryName.split(' ')[0];
                
                if (categories[mainCategory]) {
                    card.textContent = `${categories[mainCategory]}+ books`;
                }
            });
        }

        // Loading indicator functions
        function showLoadingIndicator() {
            document.body.insertAdjacentHTML('beforeend', `
                <div id="loading-overlay" style="
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                    background: rgba(255,255,255,0.9); z-index: 9999; 
                    display: flex; align-items: center; justify-content: center;
                    font-size: 1.2em; color: #2d5a3d;
                ">
                    <div style="text-align: center;">
                        <div style="font-size: 3em; margin-bottom: 20px;">üìö</div>
                        <div>Loading books from Project Gutenberg...</div>
                        <div style="margin-top: 10px; font-size: 0.9em; opacity: 0.7;">
                            This may take a few moments
                        </div>
                    </div>
                </div>
            `);
        }

        function hideLoadingIndicator() {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) overlay.remove();
        }

        // Fallback sample data with featured books
        function loadSampleData() {
            books = [
                {
                    id: 1,
                    title: "Pride and Prejudice",
                    author: "Jane Austen",
                    genre: "fiction",
                    rating: 4.8,
                    cover: "Classic Romance",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/1342/1342-h/1342-h.htm"}
                },
                {
                    id: 2,
                    title: "The Adventures of Sherlock Holmes",
                    author: "Arthur Conan Doyle",
                    genre: "mystery",
                    rating: 4.9,
                    cover: "Detective Classic",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/1661/1661-h/1661-h.htm"}
                },
                {
                    id: 3,
                    title: "Alice's Adventures in Wonderland",
                    author: "Lewis Carroll",
                    genre: "fantasy",
                    rating: 4.7,
                    cover: "Fantasy Adventure",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/11/11-h/11-h.htm"}
                },
                {
                    id: 4,
                    title: "The Great Gatsby",
                    author: "F. Scott Fitzgerald",
                    genre: "fiction",
                    rating: 4.3,
                    cover: "American Classic",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/64317/64317-h/64317-h.htm"}
                },
                {
                    id: 5,
                    title: "Frankenstein",
                    author: "Mary Shelley",
                    genre: "mystery",
                    rating: 4.6,
                    cover: "Gothic Horror",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/84/84-h/84-h.htm"}
                },
                {
                    id: 6,
                    title: "The Picture of Dorian Gray",
                    author: "Oscar Wilde",
                    genre: "fiction",
                    rating: 4.5,
                    cover: "Victorian Classic",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/174/174-h/174-h.htm"}
                },
                {
                    id: 7,
                    title: "Romeo and Juliet",
                    author: "William Shakespeare",
                    genre: "romance",
                    rating: 4.4,
                    cover: "Tragic Romance",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/1513/1513-h/1513-h.htm"}
                },
                {
                    id: 8,
                    title: "The Time Machine",
                    author: "H.G. Wells",
                    genre: "fantasy",
                    rating: 4.3,
                    cover: "Sci-Fi Classic",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/35/35-h/35-h.htm"}
                },
                {
                    id: 9,
                    title: "A Tale of Two Cities",
                    author: "Charles Dickens",
                    genre: "fiction",
                    rating: 4.2,
                    cover: "Historical Fiction",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/98/98-h/98-h.htm"}
                },
                {
                    id: 10,
                    title: "The Strange Case of Dr. Jekyll and Mr. Hyde",
                    author: "Robert Louis Stevenson",
                    genre: "mystery",
                    rating: 4.4,
                    cover: "Psychological Thriller",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/43/43-h/43-h.htm"}
                },
                {
                    id: 11,
                    title: "Wuthering Heights",
                    author: "Emily Bront√´",
                    genre: "romance",
                    rating: 4.1,
                    cover: "Gothic Romance",
                    popular: false,
                    new: true,
                    formats: {"text/html": "https://www.gutenberg.org/files/768/768-h/768-h.htm"}
                },
                {
                    id: 12,
                    title: "The Adventures of Tom Sawyer",
                    author: "Mark Twain",
                    genre: "fiction",
                    rating: 4.5,
                    cover: "American Adventure",
                    popular: false,
                    new: true,
                    formats: {"text/html": "https://www.gutenberg.org/files/74/74-h/74-h.htm"}
                },
                {
                    id: 13,
                    title: "Dracula",
                    author: "Bram Stoker",
                    genre: "mystery",
                    rating: 4.7,
                    cover: "Gothic Horror",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/345/345-h/345-h.htm"}
                },
                {
                    id: 14,
                    title: "Jane Eyre",
                    author: "Charlotte Bront√´",
                    genre: "romance",
                    rating: 4.6,
                    cover: "Victorian Romance",
                    popular: true,
                    new: false,
                    formats: {"text/html": "https://www.gutenberg.org/files/1260/1260-h/1260-h.htm"}
                },
                {
                    id: 15,
                    title: "The War of the Worlds",
                    author: "H.G. Wells",
                    genre: "fantasy",
                    rating: 4.2,
                    cover: "Sci-Fi Classic",
                    popular: false,
                    new: true,
                    formats: {"text/html": "https://www.gutenberg.org/files/36/36-h/36-h.htm"}
                }
            ];
            allBooks = [...books];
        }

        // Navigation functions
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-menu a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Find and activate the correct nav link
            const navLinks = document.querySelectorAll('.nav-menu a');
            navLinks.forEach(link => {
                if (link.onclick && link.onclick.toString().includes(sectionId)) {
                    link.classList.add('active');
                }
            });

            // Populate section content
            if (sectionId === 'home') {
                populateBooks('featured-books', books.slice(0, 6));
            } else if (sectionId === 'categories') {
                populateBooks('category-books', books);
            } else if (sectionId === 'popular') {
                populateBooks('popular-books', books.filter(book => book.popular));
            } else if (sectionId === 'new-releases') {
                populateBooks('new-books', books.filter(book => book.new));
            }
        }

        // Book rendering function
        function createBookCard(book) {
            const stars = '‚òÖ'.repeat(Math.floor(book.rating)) + '‚òÜ'.repeat(5 - Math.floor(book.rating));
            return `
                <div class="book-card" onclick="readBook(${book.id})">
                    <div class="book-cover">${book.cover}</div>
                    <div class="book-info">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">${book.author}</div>
                        <div class="book-rating">
                            <span class="stars">${stars}</span>
                            <span>${book.rating}</span>
                        </div>
                        <span class="book-genre">${book.genre.charAt(0).toUpperCase() + book.genre.slice(1)}</span>
                    </div>
                </div>
            `;
        }

        // Populate books in a container
        function populateBooks(containerId, booksToShow) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = booksToShow.map(createBookCard).join('');
            }
        }

        // Filter books by genre
        async function filterBooks(genre) {
            let filteredBooks = books.filter(book => book.genre === genre);
            
            // If we don't have enough books in this genre, fetch more
            if (filteredBooks.length < 10) {
                const moreBooks = await loadBooksByCategory(genre);
                // Add new books to our collection
                moreBooks.forEach(book => {
                    if (!books.find(b => b.id === book.id)) {
                        books.push(book);
                        allBooks.push(book);
                    }
                });
                filteredBooks = books.filter(book => book.genre === genre);
            }
            
            showSection('categories');
            populateBooks('category-books', filteredBooks);
            
            // Update section header to show category
            const sectionHeader = document.querySelector('#categories .section-header h2');
            sectionHeader.textContent = `${genre.charAt(0).toUpperCase() + genre.slice(1)} Books`;
        }

        // Enhanced search function
        function searchBooks(query) {
            const searchTerm = query.toLowerCase();
            const filteredBooks = books.filter(book => 
                book.title.toLowerCase().includes(searchTerm) ||
                book.author.toLowerCase().includes(searchTerm) ||
                book.subjects?.some(subject => subject.toLowerCase().includes(searchTerm))
            );
            
            showSection('categories');
            populateBooks('category-books', filteredBooks);
            
            const sectionHeader = document.querySelector('#categories .section-header h2');
            sectionHeader.textContent = `Search Results for "${query}"`;
        }

        // Read book function with real content loading
        async function readBook(bookId) {
            const book = books.find(b => b.id === bookId);
            if (book) {
                document.getElementById('reading-title').textContent = book.title;
                document.getElementById('reading-author').textContent = `by ${book.author}`;
                
                // Try to load actual book content
                let content = `<div style="text-align: center; padding: 40px; color: #666;">
                    <div style="font-size: 2em; margin-bottom: 20px;">üìö</div>
                    <p>Loading book content...</p>
                </div>`;
                
                document.getElementById('book-content').innerHTML = content;
                showSection('reading');
                
                // Attempt to load real content
                try {
                    const bookContent = await loadBookContent(book);
                    document.getElementById('book-content').innerHTML = bookContent;
                } catch (error) {
                    console.error('Error loading book content:', error);
                    document.getElementById('book-content').innerHTML = `
                        <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; border-left: 4px solid #4caf50;">
                            <h3>üìñ ${book.title}</h3>
                            <p><strong>Author:</strong> ${book.author}</p>
                            <p><strong>Genre:</strong> ${book.genre.charAt(0).toUpperCase() + book.genre.slice(1)}</p>
                            <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                            <h4>About this book:</h4>
                            <p>This classic work by ${book.author} is available as a free ebook from Project Gutenberg.</p>
                            <p><strong>Download Options:</strong></p>
                            <div style="margin: 15px 0;">
                                ${Object.keys(book.formats || {}).map(format => 
                                    `<a href="${book.formats[format]}" target="_blank" style="
                                        display: inline-block; 
                                        background: #4caf50; 
                                        color: white; 
                                        padding: 8px 16px; 
                                        text-decoration: none; 
                                        border-radius: 5px; 
                                        margin: 5px;
                                        font-size: 0.9em;
                                    ">${format.includes('html') ? 'üìÑ Read Online' : 
                                         format.includes('epub') ? 'üì± EPUB' : 
                                         format.includes('pdf') ? 'üìÑ PDF' : 
                                         'üìÑ ' + format.split('/')[1]?.toUpperCase()}</a>`
                                ).join('')}
                            </div>
                            <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; margin: 20px 0;">
                                <p><strong>‚úÖ Legal & Free:</strong> This book is in the public domain and completely free to read, download, and share.</p>
                            </div>
                        </div>
                    `;
                }
            }
        }

        // Load actual book content
        async function loadBookContent(book) {
            // Try to get HTML format first
            const htmlFormat = book.formats?.['text/html'] || book.formats?.['application/xhtml+xml'];
            
            if (htmlFormat) {
                try {
                    // Note: Due to CORS restrictions, we can't directly fetch the content
                    // In a real implementation, you'd need a backend proxy
                    return `
                        <div style="background: #f8f9fa; padding: 30px; border-radius: 15px;">
                            <h3>üìñ Reading "${book.title}"</h3>
                            <p><em>by ${book.author}</em></p>
                            <hr style="margin: 20px 0;">
                            <div style="background: white; padding: 30px; border-radius: 10px; line-height: 1.8;">
                                <h4>Chapter 1</h4>
                                <p>Due to browser security restrictions, we cannot directly load the full text here. However, you can read the complete book by clicking the "Read Online" link below.</p>
                                <a href="${htmlFormat}" target="_blank" style="
                                    display: inline-block; 
                                    background: #4caf50; 
                                    color: white; 
                                    padding: 12px 24px; 
                                    text-decoration: none; 
                                    border-radius: 8px; 
                                    margin: 20px 0;
                                    font-weight: bold;
                                ">üìÑ Read Full Book Online</a>
                                <p style="font-size: 0.9em; color: #666; margin-top: 20px;">
                                    <strong>Tip:</strong> The link opens the original Project Gutenberg version. 
                                    For the best reading experience, consider downloading the EPUB version to your e-reader.
                                </p>
                            </div>
                        </div>
                    `;
                } catch (error) {
                    throw new Error('Could not load book content');
                }
            }
            
            throw new Error('No readable format available');
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize with real books
            initializeBooks();
            
            // Add search functionality
            document.querySelector('.search-btn').addEventListener('click', function() {
                const query = document.querySelector('.search-box').value.trim();
                if (query) {
                    searchBooks(query);
                }
            });
            
            // Add enter key support for search
            document.querySelector('.search-box').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const query = this.value.trim();
                    if (query) {
                        searchBooks(query);
                    }
                }
            });
            
            // Start with home section
            showSection('home');
        });

        // Add error handling for API failures
        window.addEventListener('unhandledrejection', function(event) {
            console.error('API Error:', event.reason);
            // Show user-friendly error message
            if (event.reason.message?.includes('fetch')) {
                showNotification('Having trouble loading books. Please check your internet connection.', 'error');
            }
        });

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 90px; right: 20px; z-index: 1001;
                background: ${type === 'error' ? '#f44336' : '#4caf50'};
                color: white; padding: 15px 20px; border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                font-weight: 500; max-width: 400px;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 5000);
        }
    </script>
</body>
</html>
